<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="inflma.opAdmin.dao.ExcelMapper">
    <select id="transactionRequestExcel" parameterType="map" resultType="map">
        SELECT
            REPLACE ( REPLACE ( REPLACE( REPLACE ( request_info -> '$.bank' , '"', '') ,"(주택)", '') , '(외환)', '') ,'(조흥)', '')as bank ,
            REPLACE ( request_info -> '$.account' , '"','') as account,
            REPLACE ( request_info -> '$.accountName', '"', '') as name,
            request_price,
            actual_refund,
            tax_fee
        FROM account_transaction_request
        where state = 0 and Date(created_at) <![CDATA[<=]]> #{requestDate}
        order by created_at desc
    </select>
</mapper>